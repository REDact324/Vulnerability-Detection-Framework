# Vulnerability Detection Framework

A vulnerability detection framework with a fine-tuned ConvNext model. It focuses on the Windows remote desktops and reads the IP addresses to check the login interfaces.

## Examples

This project takes IP addresses as input, and scan the login interfaces of Windows remote desktops.

<p align='center'>
<img src="example/1.jpg" alt="drawing" width="60%"/>
</p>
<center>High vulnerability: Activated admin account and system update needed.</center>

<p align='center'>
<img src="example/2.jpg" alt="drawing" width="60%"/>
</p>
<center>Low vulnerability: No ativated admin account or system update needed.</center>

<p align='center'>
<img src="example/3.jpg" alt="drawing" width="60%"/>
</p>
<center>Medium vulnerability: No Activated admin account but system update needed.</center>

<p align='center'>
<img src="example/4.jpg" alt="drawing" width="60%"/>
</p>
<center>Medium vulnerability: Activated admin account but no system update needed.</center>

## Base model

Fine-tuned ConvNext-1K, 384 resolution. ConvNeXt model The ConvNeXt model is introduced by Zhuang Liu, Hanzi Mao, Chao-Yuan Wu, Christoph Feichtenhofer, Trevor Darrell, and Saining Xie in [*A ConvNet for the 2020s*](https://arxiv.org/abs/2201.03545). You can find more in their official repository [ConvNeXt](https://github.com/facebookresearch/ConvNeXt/tree/main?tab=readme-ov-file).

## Usage

Change directory to project folder

`cd Vulnerability-Detection-Framework`

And call the main program

`python main.py [-h] [--use_local] [--output_dir] input_ads`

```
usage: main.py [-h] [--use_local] [--output_dir] input_ads
positional arguments:
  input_ads             input_ads the IP address or a directory of text file

options:
  -h, --help            show this help message and exit
  --use_local           load model from local
  --output_dir OUTPUT_DIR
                        directory of output text file
```
Input an IP address (ex. `0.0.0.0:1000`) or a text file that stores multiple IP addresses.

## Local Model Option

Download config file and model in directory `/Vulnerability-Detection-Framework/model`. If you want to apply my model locally, you can download [here](https://huggingface.co/REDact123/Vulnerabilty_ConvNeXt_384).

```
----- Vulnerability-Detection-Framework
    ----- model
        - config.JSON
        - model.safetensors
        - preprocessor_config.json
    ----- src
    - main.py
```

**Note that this project only support custom model and feature extractor for now.**

## Catalog

- [ ] Add pre-trained processor option.
- [ ] Google Colab inference example.
- [ ] Fine-tuning code.
- [ ] Data collecting code (Shodan.io API).
